let searchFunc=function(path,search_id,content_id){"use strict";new Request(path);let xhr=new XMLHttpRequest;xhr.open("GET",path),xhr.responseType="document",xhr.overrideMimeType("text/xml"),xhr.onload=function(){if(xhr.readyState===xhr.DONE&&200===xhr.status){let datas=[];xhr.responseXML.querySelectorAll("entry").forEach(entry=>{datas.push({title:entry.querySelector("title").innerHTML,content:entry.querySelector("content").innerHTML,url:entry.querySelector("url").innerHTML})});let $input=document.getElementById(search_id);if(!$input)return;let $resultContent=document.getElementById(content_id);document.querySelectorAll("#local-search-input").length>0&&$input.addEventListener("input",function(){let str='<ul class="search-result-list">',keywords=this.value;keywords=keywords.trim().toLowerCase().split(/[\s\-]+/),$resultContent.innerHTML="",this.value.trim().length<=0||(datas.forEach(function(data){let isMatch=!0;data.title&&""!==data.title.trim()||(data.title="Untitled");let data_title=data.title.trim().toLowerCase(),data_content=data.content.trim().replace(/<[^>]+>/g,"").toLowerCase(),data_url=data.url,index_title=-1,index_content=-1,first_occur=-1;if(""!==data_content?keywords.forEach(function(keyword,i){index_title=data_title.indexOf(keyword),index_content=data_content.indexOf(keyword),index_title<0&&index_content<0?isMatch=!1:(index_content<0&&(index_content=0),0===i&&(first_occur=index_content))}):isMatch=!1,isMatch){str+="<li><a href='"+data_url+"' class='search-result-title'>"+data_title+"</a>";let content=data.content.trim().replace(/<[^>]+>/g,"");if(first_occur>=0){let start=first_occur-20,end=first_occur+80;start<0&&(start=0),0===start&&(end=100),end>content.length&&(end=content.length);let match_content=content.substring(start,end);keywords.forEach(function(keyword){let regS=new RegExp(keyword,"gi");match_content=match_content.replace(regS,'<em class="search-keyword">'+keyword+"</em>")}),str+='<p class="search-result">'+match_content+"...</p>"}str+="</li>"}}),str+="</ul>",$resultContent.innerHTML=str)})}},xhr.send()};searchFunc(CONFIG.local_search.path,"local-search-input","local-search-result");