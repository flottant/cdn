const blogNameWidth=$("#blog_name").width(),menusWidth=$(".menus").width(),sidebarWidth=$("#sidebar").width(),adjustMenu=function(n){const $nav=$("#nav");let t;(t=0===n||(1===n?blogNameWidth+menusWidth>$nav.width()-sidebarWidth-30:blogNameWidth+menusWidth>$nav.width()-30))?($nav.find(".toggle-menu").addClass("is-visible-inline"),$nav.find(".menus_items").addClass("is-invisible"),$nav.find("#search_button span").addClass("is-invisible")):($nav.find(".toggle-menu").removeClass("is-visible-inline"),$nav.find(".menus_items").removeClass("is-invisible"),$nav.find("#search_button span").removeClass("is-invisible"))},initAdjust=()=>{window.innerWidth<768?adjustMenu(0):adjustMenu(2),$("#nav").css({opacity:"1",animation:"headerNoOpacity 1s"})},OpenSidebarAuto=()=>{window.innerWidth>1024&&$("#toggle-sidebar").hasClass("on")&&setTimeout(function(){openSidebar()},400)},closeSidebar=()=>{$("#sidebar").removeClass("tocOpenPc").animate({left:"-300px"},400),$(".menus").animate({paddingRight:0},400),$("#body-wrap").animate({paddingLeft:0},400),$("#toggle-sidebar").css({transform:"rotateZ(0deg)",color:"#1F2D3D",opacity:"1"}),setTimeout(function(){adjustMenu(2)},400)},openSidebar=()=>{adjustMenu(1),$("#sidebar").addClass("tocOpenPc").animate({left:0},400),$(".menus").animate({paddingRight:300},400),$("#body-wrap").animate({paddingLeft:300},400),$("#toggle-sidebar").css({transform:"rotateZ(180deg)",color:"#99a9bf",opacity:"1"})},toggleSidebar=function(){$("#toggle-sidebar").on("click",function(){const isOpen=$(this).hasClass("on");isOpen?$(this).removeClass("on"):$(this).addClass("on"),isOpen?closeSidebar():openSidebar()})},sidebarFn=()=>{const $toggleMenu=$(".toggle-menu"),$mobileSidebarMenus=$("#mobile-sidebar-menus"),$mobileTocButton=$("#mobile-toc-button"),$menuMask=$("#menu_mask"),$body=$("body"),$sidebar=$("#sidebar");function openMobileSidebar(name){sidebarPaddingR(),$body.css("overflow","hidden"),$menuMask.fadeIn(),"menu"===name&&($toggleMenu.removeClass("close").addClass("open"),$mobileSidebarMenus.addClass("open")),"toc"===name&&($mobileTocButton.removeClass("close").addClass("open"),$sidebar.addClass("tocOpenMobile").css({transform:"translate3d(-100%,0,0)",left:""}))}function closeMobileSidebar(name){$body.css({overflow:"","padding-right":""}),$menuMask.fadeOut(),"menu"===name&&($toggleMenu.removeClass("open").addClass("close"),$mobileSidebarMenus.removeClass("open")),"toc"===name&&($mobileTocButton.removeClass("open").addClass("close"),$sidebar.removeClass("tocOpenMobile").css({transform:""}))}$toggleMenu.on("click",function(){openMobileSidebar("menu")}),$mobileTocButton.on("click",function(){openMobileSidebar("toc")}),$menuMask.on("click touchstart",function(e){$toggleMenu.hasClass("open")&&closeMobileSidebar("menu"),$mobileTocButton.hasClass("open")&&closeMobileSidebar("toc")}),$(window).on("resize",function(e){$toggleMenu.is(":visible")||$toggleMenu.hasClass("open")&&closeMobileSidebar("menu")}),window.matchMedia("(max-width: 1024px)").addListener(function(ev){ev.matches?$sidebar.hasClass("tocOpenPc")&&closeSidebar():($("#toggle-sidebar").hasClass("on")&&openSidebar(),$mobileTocButton.hasClass("open")&&closeMobileSidebar("toc"))}),$sidebar.find(".toc-link").on("click",function(e){window.innerWidth<=1024?closeMobileSidebar("toc"):(e.preventDefault(),scrollToDest(decodeURI($(this).attr("href"))))})},scrollDownInIndex=()=>{$("#scroll_down").on("click",function(){scrollToDest("#content-inner")})},addHighlightTool=function(){const $figureHighlight=$("figure.highlight"),isHighlightCopy=GLOBAL_CONFIG.highlightCopy,isHighlightLang=GLOBAL_CONFIG.highlightLang,isHighlightShrink=GLOBAL_CONFIG_SITE.isHighlightShrink;if($figureHighlight.length&&(isHighlightCopy||isHighlightLang||void 0!==isHighlightShrink)){let highlightShrinkEle="",highlightCopyEle="";const highlightShrinkClass=!0===isHighlightShrink?"closed":"";if(void 0!==isHighlightShrink&&(highlightShrinkEle=`<i class="fas fa-angle-down expand ${highlightShrinkClass}"></i>`),isHighlightCopy&&(highlightCopyEle='<div class="copy-notice"></div><i class="fas fa-paste copy-button"></i>'),isHighlightLang){let langName;$figureHighlight.each(function(){const $this=$(this);"plain"!==(langName=$this.attr("class").split(" ")[1])&&void 0!==langName||(langName="Code");const highlightLangEle=`<div class="code-lang">${langName}</div>`;$this.prepend(`<div class="highlight-tools ${highlightShrinkClass}">${highlightShrinkEle+highlightLangEle+highlightCopyEle}</div>`)})}else $figureHighlight.prepend(`<div class="highlight-tools ${highlightShrinkClass}">${highlightShrinkEle+highlightCopyEle}</div>`);if(void 0!==isHighlightShrink&&$figureHighlight.find(".highlight-tools >.expand").on("click",function(){const $this=$(this),$table=$this.parent().nextAll();$this.toggleClass("closed"),$table.is(":visible")?$table.css("display","none"):$table.css("display","block")}),isHighlightCopy){const copy=function(text,ctx){document.queryCommandSupported&&document.queryCommandSupported("copy")?(document.execCommand("copy"),void 0!==GLOBAL_CONFIG.Snackbar?snackbarShow(GLOBAL_CONFIG.copy.success):$(ctx).prev(".copy-notice").text(GLOBAL_CONFIG.copy.success).animate({opacity:1},450,function(){setTimeout(function(){$(ctx).prev(".copy-notice").animate({opacity:0},650)},400)})):void 0!==GLOBAL_CONFIG.Snackbar?snackbarShow(GLOBAL_CONFIG.copy.noSupport):$(ctx).prev(".copy-notice").text(GLOBAL_CONFIG.copy.noSupport)};$figureHighlight.find(".highlight-tools >.copy-button").on("click",function(){const $buttonParent=$(this).parents("figure.highlight");$buttonParent.addClass("copy-true");const selection=window.getSelection(),range=document.createRange();range.selectNodeContents($buttonParent.find("table .code pre")[0]),selection.removeAllRanges(),selection.addRange(range);const text=selection.toString();copy(text,this),selection.removeAllRanges(),$buttonParent.removeClass("copy-true")})}}};function addPhotoFigcaption(){$("#article-container img").not(".justified-gallery img").each(function(i,o){const $this=$(o);if($this.attr("alt")){const t=$('<div class="img-alt is-center">'+$this.attr("alt")+"</div>");$this.after(t)}})}let detectJgJsLoad=!1;const runJustifiedGallery=function(){const $justifiedGallery=$(".justified-gallery");if($justifiedGallery.length){const $imgList=$justifiedGallery.find("img");$imgList.unwrap(),$imgList.length&&$imgList.each(function(i,o){$(o).attr("data-lazy-src")&&$(o).attr("src",$(o).attr("data-lazy-src")),$(o).wrap("<div></div>")}),detectJgJsLoad?initJustifiedGallery($justifiedGallery):($("head").append(`<link rel="stylesheet" type="text/css" href="${GLOBAL_CONFIG.justifiedGallery.css}">`),$.getScript(`${GLOBAL_CONFIG.justifiedGallery.js}`,function(){initJustifiedGallery($justifiedGallery)}),detectJgJsLoad=!0)}},addLightBox=function(){const isMediumZoom=GLOBAL_CONFIG.medium_zoom;if(GLOBAL_CONFIG.fancybox){$("#article-container img:not(.gallery-group-img)").not($("a>img")).each(function(i,o){const lazyloadSrc=$(o).attr("data-lazy-src")?$(o).attr("data-lazy-src"):$(o).attr("src"),dataCaption=$(o).attr("alt")?$(o).attr("alt"):"";$(o).wrap(`<a href="${lazyloadSrc}" data-fancybox="group" data-caption="${dataCaption}" class="fancybox"></a>`)}),$().fancybox({selector:"[data-fancybox]",loop:!0,transitionEffect:"slide",protect:!0,buttons:["slideShow","fullScreen","thumbs","close"],hash:!1})}else if(isMediumZoom){const zoom=mediumZoom(document.querySelectorAll("#article-container :not(a)>img"));zoom.on("open",function(event){const photoBg="dark"===$(document.documentElement).attr("data-theme")?"#121212":"#fff";zoom.update({background:photoBg})})}},scrollFn=function(){let initTop=0,isChatShow=!0;const $rightside=$("#rightside"),$nav=$("#nav"),isChatBtnHide="function"==typeof chatBtnHide,isChatBtnShow="function"==typeof chatBtnShow;$(window).scroll(throttle(function(event){const currentTop=$(this).scrollTop(),isDown=function(currentTop){const result=currentTop>initTop;return initTop=currentTop,result}(currentTop);currentTop>56?(isDown?($nav.hasClass("visible")&&$nav.removeClass("visible"),isChatBtnShow&&!0===isChatShow&&(chatBtnHide(),isChatShow=!1)):($nav.hasClass("visible")||$nav.addClass("visible"),isChatBtnHide&&!1===isChatShow&&(window.chatBtnShow(),isChatShow=!0)),$nav.addClass("fixed"),"0"===$rightside.css("opacity")&&$rightside.css({opacity:"1",transform:"translateX(-38px)"})):(0===currentTop&&$nav.removeClass("fixed").removeClass("visible"),$rightside.css({opacity:"",transform:""}))},200))},tocFn=function(){$(".toc-child").hide(),$(window).scroll(throttle(function(event){const currentTop=$(this).scrollTop();scrollPercent(currentTop),findHeadPosition(currentTop),autoScrollToc(currentTop)},100));const scrollPercent=function(currentTop){const docHeight=$("#article-container").height(),winHeight=$(window).height(),scrollPercent=currentTop/(docHeight>winHeight?docHeight-winHeight:$(document).height()-winHeight),scrollPercentRounded=Math.round(100*scrollPercent),percentage=scrollPercentRounded>100?100:scrollPercentRounded<=0?0:scrollPercentRounded;$(".progress-num").text(percentage),$(".sidebar-toc__progress-bar").animate({width:percentage+"%"},100)},isAnchor=GLOBAL_CONFIG.isanchor,findHeadPosition=function(top){if(0===$(".toc-link").length)return!1;let currentId="";$("#article-container").find("h1,h2,h3,h4,h5,h6").each(function(){const head=$(this);top>head.offset().top-25&&(currentId="#"+encodeURI($(this).attr("id")))}),""===currentId&&($(".toc-link").removeClass("active"),$(".toc-child").hide());const currentActive=$(".toc-link.active");if(currentId&&currentActive.attr("href")!==currentId){isAnchor&&(anchor=currentId,window.history.replaceState&&anchor!==window.location.hash&&window.history.replaceState(void 0,void 0,anchor)),$(".toc-link").removeClass("active");const _this=$('.toc-link[href="'+currentId+'"]');_this.addClass("active");const parents=_this.parents(".toc-child"),topLink=parents.length>0?parents.last():_this;($item=topLink.closest(".toc-item").find(".toc-child")).is(":visible")||$item.fadeIn(400),topLink.closest(".toc-item").siblings(".toc-item").find(".toc-child").hide()}var $item,anchor},autoScrollToc=function(currentTop){if($(".toc-link").hasClass("active")){const activePosition=$(".active").offset().top,sidebarScrollTop=$("#sidebar .sidebar-toc__content").scrollTop();activePosition>currentTop+$(window).height()-100&&$("#sidebar .sidebar-toc__content").scrollTop(sidebarScrollTop+100),activePosition<currentTop+100&&$("#sidebar .sidebar-toc__content").scrollTop(sidebarScrollTop-100)}}},$rightsideEle=$("#rightside");$rightsideEle.on("click","#readmode",function(){$("body").toggleClass("read-mode")});const originFontSize=$("body").css("font-size");if($rightsideEle.on("click","#font_plus",()=>{const nowFontSize=parseFloat($("body").css("font-size"));nowFontSize<20&&$("body").css("font-size",nowFontSize+1)}),$rightsideEle.on("click","#font_minus",()=>{const nowFontSize=parseFloat($("body").css("font-size"));nowFontSize>10&&$("body").css("font-size",nowFontSize-1)}),$("#darkmode").length){const switchReadMode=function(){"light"===("dark"===document.documentElement.getAttribute("data-theme")?"dark":"light")?(activateDarkMode(),Cookies.set("theme","dark",2),void 0!==GLOBAL_CONFIG.Snackbar&&snackbarShow(GLOBAL_CONFIG.Snackbar.day_to_night)):(activateLightMode(),Cookies.set("theme","light",2),void 0!==GLOBAL_CONFIG.Snackbar&&snackbarShow(GLOBAL_CONFIG.Snackbar.night_to_day))};$rightsideEle.on("click","#darkmode",()=>{switchReadMode(),"function"==typeof utterancesTheme&&utterancesTheme(),"object"==typeof FB&&window.loadFBComment(),window.DISQUS&&$("#disqus_thread").children().length&&setTimeout(()=>window.disqusReset(),200)})}$rightsideEle.on("click","#rightside_config",()=>$("#rightside-config-hide").toggleClass("show")),$rightsideEle.on("click","#go-up",()=>scrollToDest("body"));const clickFnOfSubMenu=function(){$("#mobile-sidebar-menus .expand").on("click",function(){$(this).parents(".menus_item").find("> .menus_item_child").slideToggle(),$(this).toggleClass("closed")}),$(window).on("touchmove",function(e){const $menusChild=$("#nav .menus_item_child");$menusChild.is(":visible")&&$menusChild.css("display","none")})},addCopyright=()=>{const copyright=GLOBAL_CONFIG.copyright;document.body.oncopy=(e=>{let textFont;e.preventDefault();const copyFont=window.getSelection(0).toString();return textFont=copyFont.length>copyright.limitCount?copyFont+"\n\n\n"+copyright.languages.author+"\n"+copyright.languages.link+window.location.href+"\n"+copyright.languages.source+"\n"+copyright.languages.info:copyFont,e.clipboardData?e.clipboardData.setData("text",textFont):window.clipboardData.setData("text",textFont)})},addRuntime=()=>{const $runtimeCount=$("#webinfo-runtime-count");if($runtimeCount.length){const publishDate=$runtimeCount.attr("publish_date");$runtimeCount.text(diffDate(publishDate)+" "+GLOBAL_CONFIG.runtime_unit)}},addTableWrap=function(){$("#article-container table").not($("figure.highlight > table")).each(function(){$(this).wrap('<div class="table-wrap"></div>')})},pushToBaidu=()=>{const bp=document.createElement("script"),curProtocol=window.location.protocol.split(":")[0];bp.src="https"===curProtocol?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",bp.dataset.pjax="";const s=document.getElementsByTagName("script")[0];s.parentNode.insertBefore(bp,s)},clickFnOfTagHide=function(){const $hideInline=$(".hide-button");$hideInline.length&&$hideInline.on("click",function(e){const $this=$(this),$hideContent=$(this).next(".hide-content");$this.toggleClass("open"),$hideContent.toggle(),$this.hasClass("open")&&$hideContent.find(".justified-gallery").length>0&&initJustifiedGallery($hideContent.find(".justified-gallery"))})},clickFnOfTabs=function(){$("#article-container .tabs").find(".tab > button").on("click",function(e){const $this=$(this),$tabItem=$this.parent();if(!$tabItem.hasClass("active")){const $tabContent=$this.parents(".nav-tabs").next();$tabItem.siblings(".active").removeClass("active"),$tabItem.addClass("active");const tabId=$this.attr("data-href");$tabContent.find("> .tab-item-content").removeClass("active"),$tabContent.find(`> ${tabId}`).addClass("active");const $isTabJustifiedGallery=$tabContent.find(tabId).find(".justified-gallery");$isTabJustifiedGallery.length>0&&initJustifiedGallery($isTabJustifiedGallery)}})},toggleCardCategory=function(){$(".card-category-list-item.parent i").on("click",function(e){e.preventDefault();const $this=$(this);$this.toggleClass("expand"),$this.parents(".parent").next().toggle()})},switchComments=function(){let switchDone=!1;$("#switch-comments-btn").on("click",function(){$("#post-comment > .comment-wrap > div").each(function(){$(this).is(":visible")?$(this).hide():$(this).css({display:"block",animation:"tabshow .5s"})}),switchDone||"function"!=typeof loadOtherComment||(switchDone=!0,loadOtherComment())})},addPostOutdateNotice=function(){const data=GLOBAL_CONFIG.noticeOutdate;var diffDay=diffDate(GLOBAL_CONFIG_SITE.postUpdate);if(diffDay>=data.limitDay){const code=`<div class="post-outdate-notice">${data.messagePrev+" "+diffDay+" "+data.messageNext}</div>`;"top"===data.position?$("#article-container").prepend(code):$("#article-container").append(code)}};GLOBAL_CONFIG.islazyload&&(window.lazyLoadOptions={elements_selector:"img",threshold:0,data_src:"lazy-src"},window.addEventListener("LazyLoad::Initialized",function(event){window.lazyLoadInstance=event.detail.instance},!1));const unRefreshFn=function(){$(window).on("resize",function(){window.innerWidth<768?adjustMenu(0):$("#sidebar").hasClass("tocOpenPc")&&$("#nav").hasClass("fixed")?adjustMenu(1):adjustMenu(2)}),$("#mobile-sidebar-menus .expand").on("click",function(){$(this).parents(".menus_item").find("> .menus_item_child").slideToggle(),$(this).toggleClass("closed")}),$(window).on("touchmove",function(e){const $menusChild=$("#nav .menus_item_child");$menusChild.is(":visible")&&$menusChild.css("display","none")}),void 0!==GLOBAL_CONFIG.copyright&&addCopyright(),GLOBAL_CONFIG.baiduPush&&pushToBaidu()},refreshFn=function(){window.innerWidth<768?adjustMenu(0):adjustMenu(2),$("#nav").css({opacity:"1",animation:"headerNoOpacity 1s"}),GLOBAL_CONFIG_SITE.isPost&&(window.innerWidth>1024&&$("#toggle-sidebar").hasClass("on")&&setTimeout(function(){openSidebar()},400),$("#toggle-sidebar").on("click",function(){const isOpen=$(this).hasClass("on");isOpen?$(this).removeClass("on"):$(this).addClass("on"),isOpen?closeSidebar():openSidebar()}),GLOBAL_CONFIG_SITE.isSidebar&&tocFn(),void 0!==GLOBAL_CONFIG.noticeOutdate&&addPostOutdateNotice()),sidebarFn(),GLOBAL_CONFIG_SITE.isHome&&$("#scroll_down").on("click",function(){scrollToDest("#content-inner")}),addHighlightTool(),GLOBAL_CONFIG.isPhotoFigcaption&&addPhotoFigcaption(),runJustifiedGallery(),addLightBox(),scrollFn(),GLOBAL_CONFIG.runtime&&addRuntime(),$("#article-container table").not($("figure.highlight > table")).each(function(){$(this).wrap('<div class="table-wrap"></div>')}),clickFnOfTagHide(),$("#article-container .tabs").find(".tab > button").on("click",function(e){const $this=$(this),$tabItem=$this.parent();if(!$tabItem.hasClass("active")){const $tabContent=$this.parents(".nav-tabs").next();$tabItem.siblings(".active").removeClass("active"),$tabItem.addClass("active");const tabId=$this.attr("data-href");$tabContent.find("> .tab-item-content").removeClass("active"),$tabContent.find(`> ${tabId}`).addClass("active");const $isTabJustifiedGallery=$tabContent.find(tabId).find(".justified-gallery");$isTabJustifiedGallery.length>0&&initJustifiedGallery($isTabJustifiedGallery)}}),$(".card-category-list-item.parent i").on("click",function(e){e.preventDefault();const $this=$(this);$this.toggleClass("expand"),$this.parents(".parent").next().toggle()}),switchComments()};$(function(){window.innerWidth<768?adjustMenu(0):adjustMenu(2),$("#nav").css({opacity:"1",animation:"headerNoOpacity 1s"}),GLOBAL_CONFIG_SITE.isPost&&(window.innerWidth>1024&&$("#toggle-sidebar").hasClass("on")&&setTimeout(function(){openSidebar()},400),$("#toggle-sidebar").on("click",function(){const isOpen=$(this).hasClass("on");isOpen?$(this).removeClass("on"):$(this).addClass("on"),isOpen?closeSidebar():openSidebar()}),GLOBAL_CONFIG_SITE.isSidebar&&tocFn(),void 0!==GLOBAL_CONFIG.noticeOutdate&&addPostOutdateNotice()),sidebarFn(),GLOBAL_CONFIG_SITE.isHome&&$("#scroll_down").on("click",function(){scrollToDest("#content-inner")}),addHighlightTool(),GLOBAL_CONFIG.isPhotoFigcaption&&addPhotoFigcaption(),runJustifiedGallery(),addLightBox(),scrollFn(),GLOBAL_CONFIG.runtime&&addRuntime(),$("#article-container table").not($("figure.highlight > table")).each(function(){$(this).wrap('<div class="table-wrap"></div>')}),clickFnOfTagHide(),$("#article-container .tabs").find(".tab > button").on("click",function(e){const $this=$(this),$tabItem=$this.parent();if(!$tabItem.hasClass("active")){const $tabContent=$this.parents(".nav-tabs").next();$tabItem.siblings(".active").removeClass("active"),$tabItem.addClass("active");const tabId=$this.attr("data-href");$tabContent.find("> .tab-item-content").removeClass("active"),$tabContent.find(`> ${tabId}`).addClass("active");const $isTabJustifiedGallery=$tabContent.find(tabId).find(".justified-gallery");$isTabJustifiedGallery.length>0&&initJustifiedGallery($isTabJustifiedGallery)}}),$(".card-category-list-item.parent i").on("click",function(e){e.preventDefault();const $this=$(this);$this.toggleClass("expand"),$this.parents(".parent").next().toggle()}),switchComments(),$(window).on("resize",function(){window.innerWidth<768?adjustMenu(0):$("#sidebar").hasClass("tocOpenPc")&&$("#nav").hasClass("fixed")?adjustMenu(1):adjustMenu(2)}),$("#mobile-sidebar-menus .expand").on("click",function(){$(this).parents(".menus_item").find("> .menus_item_child").slideToggle(),$(this).toggleClass("closed")}),$(window).on("touchmove",function(e){const $menusChild=$("#nav .menus_item_child");$menusChild.is(":visible")&&$menusChild.css("display","none")}),void 0!==GLOBAL_CONFIG.copyright&&addCopyright(),GLOBAL_CONFIG.baiduPush&&pushToBaidu()});